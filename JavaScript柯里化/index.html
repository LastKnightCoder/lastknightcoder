<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="熊滔"><meta name="description" content="人生天地间，忽如远行客"><link rel="alternative" href="/atom.xml" title="Coder" type="application/atom+xml"><link rel="icon" href="/favicon.png"><title>JavaScript柯里化 - Coder</title>
<link rel="stylesheet" href="https://lastknightcoder.gitee.io/css/main.css">

<link rel="stylesheet" href="https://lastknightcoder.gitee.io/js/fancybox/jquery.fancybox.min.css">
<!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]-->
<script src="https://lastknightcoder.gitee.io/js/jquery-3.1.1.min.js"></script>

<script src="https://lastknightcoder.gitee.io/js/fancybox/jquery.fancybox.min.js"></script>
<meta name="generator" content="Hexo 4.2.0"></head><body style="opacity:0"><header class="head"><h1 class="head-title u-fl"><a href="https://lastknightcoder.gitee.io/">Coder</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a class="head-nav__link" href="https://lastknightcoder.gitee.io/tags">标签</a></li><li class="head-nav__item"><a class="head-nav__link" href="https://lastknightcoder.gitee.io/archives">目录</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"><time class="post__time" datetime="2020-04-20T16:00:00.000Z">2020-04-21 00:00:00</time><h1 class="post__title"><a href="https://lastknightcoder.gitee.io/JavaScript%E6%9F%AF%E9%87%8C%E5%8C%96/">JavaScript柯里化</a></h1><div class="post__main echo"><h2 id="柯里化介绍"><a href="#柯里化介绍" class="headerlink" title="柯里化介绍"></a>柯里化介绍</h2><p>函数柯里化指的是函数处理一部分的参数，然后返回一个函数来处理剩余的参数，如比如有一个加法函数如下</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line">add(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>

<p>现在如果这个函数被柯里化，那么我们可以如下使用</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> increment = add(<span class="number">1</span>); <span class="comment">// 接收第一个参数，返回一个函数处理第二个参数</span></span><br><span class="line">increment(<span class="number">2</span>); <span class="comment">// 3</span></span><br><span class="line">increment(<span class="number">4</span>); <span class="comment">// 5</span></span><br></pre></td></tr></table></figure>

<h2 id="柯里化实现"><a href="#柯里化实现" class="headerlink" title="柯里化实现"></a>柯里化实现</h2><p>现在怎么实现这种效果，如果只是针对上面的加法函数，那么可以如下实现</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">y</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x + y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是这种方法明显只对加法函数有效，我们现在是想设计一个函数，它接收一个函数为参数，作用就是把这个函数柯里化，并将这个柯里化的函数返回，比如</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">curryAdd = curry(add); <span class="comment">// 接收add函数，将函数add柯里化</span></span><br><span class="line"><span class="keyword">const</span> increment = curryAdd(<span class="number">1</span>);</span><br><span class="line">increment(<span class="number">2</span>); <span class="comment">// 3</span></span><br><span class="line">increment(<span class="number">4</span>); <span class="comment">// 5</span></span><br></pre></td></tr></table></figure>

<p>首先实现一个简单版本的</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">curry</span>(<span class="params">fn, ...args1</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">...args2</span>) </span>&#123;</span><br><span class="line">        fn(...args1, ...args2)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是这个函数明显有一个缺陷，那就是只能传入两次参数，怎么解决，肯定使用递归了</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">curry</span>(<span class="params">fn, ...args1</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (fn.length == args1.length) &#123;</span><br><span class="line">        <span class="keyword">return</span> fn(...args1);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">...args2</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> curry(fn, ...args1, ...args2)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面的函数首先判断接收的参数的个数与函数要求参数的个数是否相同，如果相同则直接执行函数，否则返回一个函数来处理剩下的参数，这样就可以实现函数的柯里化。</p>
<h2 id="柯里化应用举例"><a href="#柯里化应用举例" class="headerlink" title="柯里化应用举例"></a>柯里化应用举例</h2><p>现在来看一下柯里化有什么用处，假设有一个 <code>ajax</code> 请求的函数如下</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ajax</span>(<span class="params">type, url, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    xhr.onReadystateChange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    xhr.open(type, url);</span><br><span class="line">    xhr.send(data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>现在我们将这个函数柯里化</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> curriedAjax = curry(ajax);</span><br><span class="line"><span class="keyword">let</span> post = curriedAjax(<span class="string">'post'</span>);</span><br></pre></td></tr></table></figure>

<p>我们向 <code>curriedAjax</code> 传入一个参数 <code>post</code>，得到一个函数，这个函数的作用是用来发 <code>post</code> 请求的，我们每次发 <code>post</code> 请求时，只需要使用 <code>post</code> 方法即可，这样函数的复用性有了极大的增强，我们可以继续传入参数</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> postGoogle = post(<span class="string">'https://www.google.com'</span>);</span><br></pre></td></tr></table></figure>

<p>我们又得到了一个函数，该函数的作用是向 <code>https://www.google.com</code> 发送 <code>post</code> 请求，函数的复用性又进一步的提升。</p>
<blockquote>
<p>使用过 <code>jQuery</code> 的都知道，可以使用 <code>$.ajax()</code> 这样的通用方法，但是也有 <code>$.get()</code> 和 <code>$.post()</code> 这样的语法糖，但是 <code>jQuery</code> 底部是不是这样实现的就不得而知了。</p>
</blockquote>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><ul>
<li><a href="https://juejin.im/post/5af13664f265da0ba266efcf" target="_blank" rel="noopener">大佬，JavaScript 柯里化，了解一下</a></li>
<li><a href="https://github.com/mqyqingfeng/Blog/issues/42" target="_blank" rel="noopener">JavaScript专题之函数柯里化</a></li>
</ul>
</div></header><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a class="post__tag__link" href="https://lastknightcoder.gitee.io/tags/JavaScript-%E6%9F%AF%E9%87%8C%E5%8C%96/">JavaScript 柯里化</a></li></ul></footer></article><section class="reward"><a class="btn-reward" href="#">打赏</a><div class="reward-wrapper clearfix"><img src="https://lastknightcoder.gitee.io/img/wechatpay.png" title="微信"><img src="https://lastknightcoder.gitee.io/img/alipay.png" title="支付宝"></div></section></main><footer class="foot"><div class="foot-copy">&copy; 2019 - 2020 熊滔</div></footer>
<script src="https://lastknightcoder.gitee.io/js/scroller.js"></script>

<script src="https://lastknightcoder.gitee.io/js/main.js"></script>
</body></html>